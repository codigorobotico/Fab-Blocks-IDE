<!DOCTYPE HTML>
<html>
<head>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script>
var chart; // Variable global para almacenar la referencia a la gráfica

window.onload = function () {

    var seriesCount = 1; // Número inicial de series en el gráfico
    var seriesIndex = 0; // Índice de la serie actual
    var dps = []; // 
	var dps2 = []; // dataPoints para la segunda serie


    // Inicializar el gráfico con una serie
    chart = new CanvasJS.Chart("chartContainer", {
        title: {
            text: "Dynamic Data"
        },
        data: [{
            type: "line",
            dataPoints: dps
        }]
    });

    var xVal = 0;
    var yVal = 100;
    var dataLength = 20; // número de dataPoints visibles en cualquier momento

    var updateChart = function () {
        chart.render();
    };

    var addDataPoint = function () {
		var y1 = parseFloat(prompt("Ingrese el valor para Y en la primera serie:"));
		var y2 = parseFloat(prompt("Ingrese el valor para Y en la segunda serie:"));
		
		if (!isNaN(y1) && !isNaN(y2)) {
			// Agregar el punto de datos a la primera serie
			dps.push({
				x: xVal,
				y: y1
			});

			// Agregar el punto de datos a la segunda serie
			dps2.push({
				x: xVal,
				y: y2
			});

			xVal++;

			if (dps.length > dataLength) {
				dps.shift();
			}

			if (dps2.length > dataLength) {
				dps2.shift();
			}

			updateChart();
		} else {
			alert("Por favor, ingrese valores válidos para ambas series.");
		}
	};

    // Agregar un botón para agregar una nueva serie
    var addSeriesButton = document.createElement("button");
    addSeriesButton.textContent = "Agregar Serie";
    addSeriesButton.onclick = function () {
        chart.options.data.push({
            type: "line",
            dataPoints: []
        });
        seriesCount++;
        seriesIndex = seriesCount - 1;
    };
    document.body.appendChild(addSeriesButton);

    // Cambiar la serie actual
    var changeSeries = function (index) {
        seriesIndex = index;
        dps = chart.options.data[seriesIndex].dataPoints;
        updateChart();
    };

    // Agregar una función a la consola para cambiar la serie actual
    window.changeSeries = changeSeries;

    // Escuchar el evento click en el botón para agregar datos
    document.getElementById("addDataButton").addEventListener("click", addDataPoint);
    
    // Función para agregar una nueva serie al gráfico
    function addNewSeries() {
        chart.options.data.push({
            type: "line",
            dataPoints: []
        });
        seriesCount++;
        seriesIndex = seriesCount - 1;
        console.log("Nueva serie agregada. Serie actual:", seriesIndex);
    }

    // Función para agregar un punto de datos a la serie actual
    function addDataPointToSeries(y) {
        if (!isNaN(y)) {
            dps = chart.options.data[seriesIndex].dataPoints;
            dps.push({
                x: xVal++,
                y: y
            });

            if (dps.length > dataLength) {
                dps.shift();
            }

            updateChart();
            console.log("Punto de datos agregado a la serie", seriesIndex);
        } else {
            console.log("Por favor, ingrese un número válido.");
        }
    }
}
</script>
</head>
<body>
<div id="chartContainer" style="height: 300px; max-width: 920px; margin: 0px auto;"></div>
<button id="addDataButton">Agregar Dato</button>
</body>
</html>
